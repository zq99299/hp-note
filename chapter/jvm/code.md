# 原码、反码、补码 - 虚拟机
本文章的知识是在葛一鸣的《实战JAVA虚拟机》一书看到的知识点，貌似也终于解惑了我在应用上的一些问题

整数在计算机中用补码表示，Java的在虚拟机中也一样；

## 什么是源码？

原码 = 符号位 + 数字的二进制

比如：

```
10  的源码：0000 0000 0000 0000 0000 0000 0000 1010
-10 的源码：1000 0000 0000 0000 0000 0000 0000 1010
```

对于源码来说，绝对值相同的正负数只有符号位不同；

## 什么是反码 ？

反码 = 原码的基础上，符号位不变，其余位取反，（正数的反码是本身）


```
10  的反码：0000 0000 0000 0000 0000 0000 0000 1010
-10 的反码：1111 1111 1111 1111 1111 1111 1111 0101
```


## 什么是补码？

补码 = 反码 + 1,(正数的反码是本身)

```
10  的补码：0000 0000 0000 0000 0000 0000 0000 1010
-10 的补码：1111 1111 1111 1111 1111 1111 1111 0110
```

在JAVA中不使用API来查看负数在虚拟机中的表现形式如下：

```java
System.out.println(Integer.toHexString(a));
System.out.println(Integer.toBinaryString(a));

输出如下：可以看出在JAVA中负数使用补码表示的
fffffff6
11111111111111111111111111110110
```

那么不使用API这么高大上的方式，要怎么获取到反码表现形式呢？

```java
int a = -10;
for (int i = 0; i < 32; i++) {
    // 0x8000 0000 是一个符号位为1，其余都为0的数
    int t = (a & (0x80000000 >>> i)) >>> (31 - i);
    System.out.println(t);
}
```
这段程序的基本思路是：循环32次，依次从左到右取到每一位数字
取对应位置数值原理：& 上一个你想要的位置上为1，其他位置上全部为0的数，然后右移动到最低位
这段程序的实现思路是：

1. 先用`0x80000000 >>> i`得到当前要获取的位置
2. 然后 a & 第一步的位
3. `>>> (31 - i) `把对应的位置移动到最后一位

比如程序中：

```
第一次：i = 0 
0x80000000 >>> i : 
1000 0000 0000 0000 0000 0000 0000 0000
--------------------------------------- 无符号右移动0位，还是原来的数
1111 1111 1111 1111 1111 1111 1111 0110 
--------------------------------------- 再&上-10，这里要特别注意，在计算机中负数用反码表示
1000 0000 0000 0000 0000 0000 0000 0000
--------------------------------------- 最后>>> (31 - i)=31
0000 0000 0000 0000 0000 0000 0000 0001 变成了1

第二次:i = 1
0x80000000 >>> i : 
1000 0000 0000 0000 0000 0000 0000 0000
--------------------------------------- 无符号右移动1位
0100 0000 0000 0000 0000 0000 0000 0000
--------------------------------------- 再&上-10
1111 1111 1111 1111 1111 1111 1111 0110 
---------------------------------------
0100 0000 0000 0000 0000 0000 0000 0000
---------------------------------------最后>>> (31 - i)=30
0000 0000 0000 0000 0000 0000 0000 0001 拿到了正数 第2位，依次类推
```

## 使用补码能解决什么？

1.  能解决 0 的存储问题；如下：
    
    ```
    0  的补码： 0000 0000 0000 0000 0000 0000 0000 0000
    
    -0 的原码： 1000 0000 0000 0000 0000 0000 0000 0000
    -0 的反码： 1111 1111 1111 1111 1111 1111 1111 1111
    --------------------------------------------------- 反码 + 1
    -0 的补码： 0000 0000 0000 0000 0000 0000 0000 0000
    ```

2. 使用补码可以简化整数的加减法计算，将减法视为加法计算

    比如：计算-6 + 5 的过程如下
    ```
    -6的补码：1111 1010
    5 的补码：0000 0101
    ------------------- 相加
           ：1111 1111  这是补码，要换算成原码
    ------------------- 补码-1 等于反码
           : 1111 1110
    ------------------- 反码取反等于原码
           : 1000 0001 
    ```
    
3. xxx

 


